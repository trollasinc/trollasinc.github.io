<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Panel de administración - Trollas Inc.</title>
    <link rel="stylesheet" href="administración.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
      rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <header>Panel de administración - Trollas. Inc.</header>
    <main>
      <!-- Login -->
      <div id="loginForm">
        <h2>Iniciar sesión</h2>
        <input id="email" type="email" placeholder="Correo" />
        <input id="password" type="password" placeholder="Contraseña" />
        <button id="loginBtn">Entrar</button>
        <p id="loginMsg"></p>
      </div>

      <!-- Panel -->
      <div id="panel" class="hidden">
        <button id="logoutBtn" style="background: crimson">
          Cerrar sesión
        </button>
        <div class="navbar-admin">
          <a href="#visitantes">Visitantes</a>
          <a href="#clientes">Clientes</a>
          <a href="#blog">Blog</a>
          <a href="#detalle-de-visitas">Detalle de visitas</a>
          <a href="#correos">Correos</a>
          <a href="#ip-ban">Gestionar IPs</a>
          <a href="#documentos">Documentos</a>
          <a href="#en-desarrollo">En desarrollo</a>
        </div>

        <!-- Visitantes -->
        <div id="visitantes" class="section">
          <h3>📊 Visitantes</h3>
          <p id="contadorVisitantes">Cargando...</p>
        </div>

        <!-- Clientes -->
        <div id="clientes" class="section">
          <h3>👥 Clientes</h3>
          <h4>Agregar / Editar Cliente</h4>
          <input type="text" id="nombre" placeholder="Nombre" />
          <input type="text" id="apellidos" placeholder="Apellidos" />
          <input type="email" id="correo" placeholder="Correo" />
          <input type="tel" id="telefono" placeholder="Teléfono" />
          <input type="text" id="plan" placeholder="Plan" />
          <textarea
            id="info"
            rows="3"
            placeholder="Información adicional"></textarea>
          <input type="file" id="fotoUpload" accept="image/*" />
          <button id="addClientBtn">Guardar Cliente</button>

          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Foto</th>
                  <th>Nombre</th>
                  <th>Apellidos</th>
                  <th>Correo</th>
                  <th>Teléfono</th>
                  <th>Plan</th>
                  <th>Info</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="tbodyClientes">
                <tr>
                  <td colspan="8" style="text-align: center">
                    Cargando clientes...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Blog -->
        <div id="blog" class="section">
          <h3>📰 Subir entrada al blog</h3>
          <input id="blogTitulo" type="text" placeholder="Título" />
          <textarea
            id="blogContenido"
            rows="5"
            placeholder="Contenido (HTML permitido)"></textarea>
          <input id="blogEnlace" type="text" placeholder="Enlace opcional" />
          <button id="addBlogBtn">Publicar entrada</button>
          <p id="blogMsg"></p>
        </div>
        <!-- Gráfico de visitas -->
        <div>
          <label for="timeRange">Rango de tiempo:</label>
          <select id="timeRange">
            <option value="24h">Últimas 24 horas</option>
            <option value="30d">Últimos 30 días</option>
          </select>
        </div>

        <canvas id="visitasChart" width="600" height="300"></canvas>

        <!-- Detalle de visitas -->
        <div id="detalle-de-visitas" class="section">
          <h3>📈 Detalle de visitas</h3>
          <input type="text" id="buscarIP" placeholder="Buscar por IP..." />
          <button id="btnBuscarIP">Buscar</button>
          <button id="refreshVisitasBtn">🔄 Refrescar</button>

          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Fecha y hora</th>
                  <th>Navegador</th>
                  <th>SO</th>
                  <th>Idioma</th>
                  <th>IP</th>
                  <th>Ciudad</th>
                  <th>Página</th>
                </tr>
              </thead>
              <tbody id="tbodyVisitas">
                <tr>
                  <td colspan="7" style="text-align: center">
                    Cargando visitas...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- IP Ban Section (nueva) -->
        <div id="ip-ban" class="section">
          <h3>🛑 Gestionar IPs (ban / unban)</h3>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px">
            <div>
              <label class="muted">IP a banear</label>
              <input type="text" id="ipInput" placeholder="Ej: 203.0.113.45" />
              <label class="muted">Motivo</label>
              <input
                type="text"
                id="reasonInput"
                placeholder="Motivo del ban" />
              <label class="muted">Duración (horas, 0 = permanente)</label>
              <input
                type="number"
                id="durationInput"
                placeholder="Horas (ej: 24)" />
              <button id="banBtn" style="margin-top: 6px">Banear IP</button>
            </div>

            <div>
              <label class="muted">Desbanear IP</label>
              <input
                type="text"
                id="unbanIpInput"
                placeholder="IP a desbanear" />
              <button
                id="unbanBtn"
                style="margin-top: 6px; background: #28a745">
                Desbanear IP
              </button>

              <p class="muted" style="margin-top: 12px">Bans actuales:</p>
              <div
                class="table-container"
                style="max-height: 240px; overflow: auto">
                <table>
                  <thead>
                    <tr>
                      <th>IP</th>
                      <th>Perm</th>
                      <th>Expira</th>
                      <th>Operador</th>
                      <th>Acción</th>
                    </tr>
                  </thead>
                  <tbody id="tbodyBans">
                    <tr>
                      <td colspan="5" style="text-align: center">
                        Cargando bans...
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Correos -->
        <div id="correos" class="section">
          <h3>📧 Correos registrados</h3>
          <input
            type="text"
            id="buscarCorreo"
            placeholder="Buscar por correo..." />
          <button id="btnBuscarCorreo">Buscar</button>
          <button id="btnRefreshCorreos">🔄 Refrescar</button>

          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Correo</th>
                  <th>Fecha</th>
                </tr>
              </thead>
              <tbody id="tbodyCorreos">
                <tr>
                  <td colspan="2" style="text-align: center">Cargando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- Documentos -->
        <div id="documentos" class="section">
          <h3>📃 Documentos</h3>

          <button
            id="addDocBtn"
            style="margin-bottom: 12px; background: #007bff; color: white">
            + Añadir documento
          </button>

          <!-- Formulario de añadir/editar documento -->
          <div
            id="documentForm"
            class="hidden"
            style="
              margin-bottom: 12px;
              border: 1px solid #ccc;
              padding: 10px;
              border-radius: 8px;
            ">
            <input
              type="text"
              id="docNombre"
              placeholder="Nombre del documento" />
            <textarea
              id="docContenido"
              rows="5"
              placeholder="Contenido del documento"></textarea>
            <button id="saveDocBtn" style="margin-top: 6px">
              Guardar documento
            </button>
            <button
              id="cancelDocBtn"
              style="margin-top: 6px; background: #6c757d">
              Cancelar
            </button>
          </div>

          <!-- Tabla de documentos -->
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Última modificación</th>
                </tr>
              </thead>
              <tbody id="tbodyDocumentos">
                <tr>
                  <td colspan="2" style="text-align: center">
                    Cargando documentos...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Visor de documento -->
          <div
            id="docViewer"
            class="hidden"
            style="
              margin-top: 12px;
              border: 1px solid #ccc;
              padding: 10px;
              border-radius: 8px;
            ">
            <h4 id="viewerNombre"></h4>
            <pre id="viewerContenido" style="white-space: pre-wrap"></pre>
            <button
              id="closeViewerBtn"
              style="margin-top: 6px; background-color: crimson">
              Cerrar
            </button>
          </div>
        </div>
        <div id="en-desarrollo" class="section">
          <h3>🎮 En desarrollo</h3>
          <button onclick="location.href='Clicker/Play/'">Clicker</button>
        </div>
      </div>
    </main>

    <script type="module" src="administración.js"></script>
  </body>
</html>
